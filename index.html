<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HANGMAN v4.4.0 (r37 - SVG_RANK_SYSTEM)</title>
    <style>
        :root {
            --color-bg-primary: #0A0A0A; --color-surface: #141414; --color-func: #2A2A2A; --color-text-passive: #B0B0B0; --color-text-bright: #FFFFFF; --color-accent-primary: #00FFFF; --color-accent-bios: #00FF8A; --color-error: #FF414B; --color-success: #39FF14; --color-accent-gold: #FFD700;
            --gap-s: clamp(4px, 1vmin, 8px);
            --gap-m: clamp(8px, 2vmin, 16px);
            --gap-l: clamp(16px, 4vmin, 32px);
            --k: clamp(24px, min( (100vw - 32px)/10, (100vh - 200px)/6 ), 64px);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { height: 100%; font-size: clamp(10px, 2.5vmin, 22px); }
        body { width: 100%; height: 100%; overflow: hidden; background-color: var(--color-bg-primary); color: var(--color-text-bright); font-family: Consolas, Menlo, Courier New, monospace; font-size: 1rem; position: relative; }
        #perspective-container { perspective: 1200px; width: 100%; height: 100%; position: relative; }
        body::after { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; background: repeating-linear-gradient(0deg, rgba(0,0,0,0.5) 0px, rgba(0,0,0,0.4) 1px, transparent 2px, transparent 3px); z-index: 10; animation: scanline-scroll 20s linear infinite; }
        @keyframes scanline-scroll { to { background-position-y: 100%; } }
        body::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; background-image: linear-gradient(var(--color-surface) 1px, transparent 1px), linear-gradient(90deg, var(--color-surface) 1px, transparent 1px); background-size: 40px 40px; opacity: 0.05; z-index: -1; }
        main { width: 100%; height: 100%; position: absolute; top: 0; left: 0; transform-style: preserve-3d; }
        
        .window { width: 100%; height: 100%; padding: 0 var(--gap-l); position: absolute; top: 0; left: 0; display: flex; flex-direction: column; justify-content: space-between; align-items: center; text-align: center; opacity: 0; transform: translateZ(0px); pointer-events: none; visibility: hidden; }
        .window.active { opacity: 1; pointer-events: auto; visibility: visible; }
        @keyframes glitch-out { 0% { opacity: 1; transform: translateZ(0px) scale(1); filter: none; clip-path: inset(0 0 0 0); } 50% { opacity: 0.5; transform: translateZ(-50px) scale(1.05); } 99% { opacity: 0; transform: translateZ(-200px) scale(0.8); filter: blur(10px); clip-path: inset(50% 0 50% 0); } 100% { opacity: 0; visibility: hidden; } }
        @keyframes glitch-in { 0% { opacity: 0; transform: translateZ(-200px) scale(0.8); filter: blur(10px); clip-path: inset(50% 0 50% 0); } 50% { opacity: 0.5; transform: translateZ(-50px) scale(1.05); } 100% { opacity: 1; transform: translateZ(0px) scale(1); filter: none; clip-path: inset(0 0 0 0); } }
        .window.glitching-out { animation: glitch-out 350ms ease-in-out forwards; }
        .window.glitching-in { animation: glitch-in 350ms ease-in-out forwards; }
        .window-content { flex-grow: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: var(--gap-m) 0; min-height: 0; }
        #preload, #title, #victory, #gameOver { justify-content: center; padding: var(--gap-m) var(--gap-l); }

        h1 { font-size: clamp(2rem, 10vmin, 5rem); color: var(--color-accent-primary); letter-spacing: clamp(4px, 1vmin, 8px); text-shadow: 0 0 5px var(--color-accent-primary), 0 0 15px var(--color-accent-primary), 0 0 25px var(--color-accent-primary); max-width: 100%; word-break: break-word; }
        h2 { font-size: clamp(1.5rem, 6vmin, 3rem); color: var(--color-text-bright); margin-bottom: var(--gap-m); }
        p { font-size: clamp(0.8rem, 2.5vmin, 1.1rem); color: var(--color-text-passive); max-width: 90%; line-height: 1.6; }
        .interactive-button, button { background-color: var(--color-func); border: 2px solid var(--color-surface); color: var(--color-text-bright); padding: var(--gap-s) var(--gap-m); font-family: inherit; font-size: clamp(0.9rem, 2.5vmin, 1.2rem); cursor: pointer; text-transform: uppercase; transition: background-color 220ms, border-color 220ms, color 220ms, opacity 220ms, transform 220ms; flex-shrink: 0; }
        
        .telemetry-header, .telemetry-footer { width: 100%; flex-shrink: 0; text-transform: uppercase; color: var(--color-text-passive); font-size: clamp(0.7rem, 2vmin, 0.9rem); letter-spacing: 2px; }
        .telemetry-header { display: flex; justify-content: space-between; align-items: center; padding: var(--gap-s); border-bottom: 1px solid var(--color-surface); position: relative; }
        .telemetry-footer { padding: var(--gap-s); border-top: 1px solid var(--color-surface); }
        .telemetry-group { display: flex; align-items: center; gap: var(--gap-m); }
        
        .settings-button { background: none; border: none; font-size: clamp(1.2rem, 4vmin, 1.8rem); color: var(--color-text-passive); cursor: pointer; padding: 0 var(--gap-s); transition: color 220ms, transform 220ms; }
        .settings-menu { position: absolute; top: 100%; right: 0; background-color: var(--color-bg-primary); border: 1px solid var(--color-surface); z-index: 100; display: flex; flex-direction: column; opacity: 0; visibility: hidden; transform: translateY(-10px); pointer-events: none; transition: opacity 220ms, visibility 220ms, transform 220ms; }
        .settings-menu.active { opacity: 1; visibility: visible; transform: translateY(0); pointer-events: auto; }
        .settings-menu button { width: 100%; text-align: left; background-color: var(--color-func); border: none; font-size: clamp(0.8rem, 2vmin, 1rem); border-top: 1px solid var(--color-surface); }
        .palette-container { position: relative; }
        .palette-submenu { display: none; position: absolute; top: 0; right: 100%; background-color: var(--color-bg-primary); border: 1px solid var(--color-surface); }
        .palette-container.open .palette-submenu { display: block; }
        
        #glitch-wrapper.glitch-active { animation: glitch-error-effect 300ms ease-in-out; }
        @keyframes glitch-error-effect { 0%, 100% { transform: translate(0, 0); } 10% { transform: translate(-5px, -3px) skewX(-5deg); } 30% { transform: translate(3px, 5px) skewX(5deg); } 50% { transform: translate(-3px, -5px); } 70% { transform: translate(5px, 3px); } 90% { transform: translate(-3px, 3px) skewX(-2deg); } }
        #holographic-panel { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: var(--gap-m); transform-style: preserve-3d; transform: rotateX(10deg); transition: transform 0.1s linear, filter 300ms; filter: drop-shadow(0 0 15px rgba(0, 255, 255, 0.4)); width: 100%; max-width: 100%; }
        #holographic-panel.error-flash { filter: drop-shadow(0 0 25px rgba(255, 0, 0, 0.8)) blur(1px); }
        #levelGrid { display: flex; flex-direction: column; gap: var(--gap-m); max-width: 450px; width: 100%; }
        
        #undo-notification { position: fixed; bottom: var(--gap-l); left: 50%; transform: translateX(-50%); background-color: var(--color-surface); border: 1px solid var(--color-accent-bios); padding: var(--gap-m); display: flex; align-items: center; gap: var(--gap-l); z-index: 200; border-radius: 4px; opacity: 0; visibility: hidden; transition: opacity 300ms, visibility 300ms; }
        #undo-notification.visible { opacity: 1; visibility: visible; }
        #undo-notification button { background-color: var(--color-accent-bios); color: var(--color-bg-primary); border-color: transparent; }

        #profilesList { list-style: none; margin-bottom: var(--gap-m); display: flex; flex-direction: column; gap: var(--gap-s); max-height: 50vh; width: 100%; max-width: 450px; }
        .delete-button { width: clamp(38px, 10vmin, 48px); height: clamp(38px, 10vmin, 48px); padding: 0; font-size: clamp(1rem, 4vmin, 1.5rem); flex-shrink: 0; background-color: var(--color-error); border-color: #8B0000; }
        #levelGrid button { padding: var(--gap-m); font-size: clamp(1rem, 4vmin, 1.5rem); display: flex; align-items: center; }
        .level-button-content { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        
        .rank-icon-container { width: 2.5em; height: 2.5em; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
        .rank-icon-container svg { width: 100%; height: 100%; fill: #555; }
        .rank-icon-container svg.rank-1, .rank-icon-container svg.rank-2 { fill: #8B4513; }
        .rank-icon-container svg.rank-3, .rank-icon-container svg.rank-4 { fill: #C0C0C0; }
        .rank-icon-container svg.rank-5, .rank-icon-container svg.rank-6, .rank-icon-container svg.rank-7, .rank-icon-container svg.rank-8, .rank-icon-container svg.rank-9 { fill: var(--color-accent-gold); }
        
        #mainMenuHeader { display: flex; align-items: center; gap: var(--gap-m); }
        #mainMenuHeader .rank-icon-container { width: 1em; height: 1em; }

        .perfect-run-icon { color: var(--color-accent-gold); text-shadow: 0 0 8px var(--color-accent-gold); display: none; }
        .perfect-run-icon.achieved { display: inline-block; }
        #gameDefinition { font-size: clamp(1rem, 3.5vmin, 1.5rem); color: var(--color-accent-gold); max-height: 5em; line-height: 1.5; overflow: hidden; }
        #wordDisplay { display: flex; gap: var(--gap-s); margin: var(--gap-m) 0; flex-wrap: wrap; justify-content: center; width: 100%; }
        .word-letter { width: clamp(28px, 10vmin, 60px); height: clamp(34px, 12vmin, 70px); font-size: clamp(1.5rem, 8vmin, 3.5rem); display: flex; justify-content: center; align-items: center; background-color: var(--color-surface); border-bottom: 4px solid var(--color-accent-primary); color: var(--color-text-bright); }
        #gameKeyboard { display: grid; grid-template-columns: repeat(9, clamp(28px, 8vmin, 65px)); gap: var(--gap-s); width: 100%; max-width: 900px; justify-content: center; }
        #gameKeyboard .key { aspect-ratio: 1 / 1; font-size: clamp(1rem, 4vmin, 2rem); padding: 0; }
        @keyframes warning-pulse { 50% { box-shadow: 0 0 12px var(--color-error), 0 0 4px var(--color-error); } }
        #mistakesDisplay { display: flex; gap: var(--gap-s); margin-bottom: var(--gap-m); align-items: center; }
        #mistakesDisplay::before { content: 'SYSTEM INTEGRITY:'; color: var(--color-text-passive); font-size: clamp(0.7rem, 2vmin, 0.9rem); letter-spacing: 2px; margin-right: var(--gap-m); }
        .mistake-segment { width: clamp(20px, 5vmin, 32px); height: clamp(23px, 5.7vmin, 36px); background-color: var(--color-surface); transition: background-color 200ms; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); box-shadow: inset 0 0 0 2px var(--color-func); }
        .mistake-segment.filled { background-color: var(--color-error); box-shadow: 0 0 8px var(--color-error); animation: warning-pulse 1.5s infinite ease-in-out; }
    </style>
</head>
<body>
    <div id="svg-definitions" style="display: none;">
        <svg id="rank-glyph-0" viewBox="0 0 100 100"><path d="M20 70 L50 40 L80 70" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-1" viewBox="0 0 100 100"><path d="M20 70 L50 40 L80 70 M20 85 L80 85" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-2" viewBox="0 0 100 100"><path d="M50 10 L90 50 L50 90 L10 50 Z" fill="currentColor"/></svg>
        <svg id="rank-glyph-3" viewBox="0 0 100 100"><path d="M20 50 L50 20 L80 50 M20 75 L50 45 L80 75" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-4" viewBox="0 0 100 100"><path d="M20 40 L50 10 L80 40 M20 65 L50 35 L80 65 M20 90 L50 60 L80 90" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-5" viewBox="0 0 100 100"><path d="M20 65 L50 35 L80 65 M20 90 L50 60 L80 90"/><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
        <svg id="rank-glyph-6" viewBox="0 0 100 100"><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
        <svg id="rank-glyph-7" viewBox="0 0 100 100"><path d="M10 90 L50 50 L90 90 M10 70 L50 30 L90 70 M10 50 L50 10 L90 50" fill="none" stroke="currentColor" stroke-width="8"/><polygon points="50,35 55,50 70,50 58,60 62,75 50,65 38,75 42,60 30,50 45,50" fill="currentColor"/></svg>
        <svg id="rank-glyph-8" viewBox="0 0 100 100"><path d="M0 50 L30 65 L30 35 Z M100 50 L70 65 L70 35 Z" fill="currentColor"/><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
        <svg id="rank-glyph-9" viewBox="0 0 100 100"><path d="M0,70 A50,50 0 0,1 100,70 M0,70 A60,60 0 0,1 100,70" fill="none" stroke-width="8" stroke="currentColor"/><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
    </div>
    <div id="perspective-container">
        <main id="appContainer">
            <div id="preload" class="window active"><H1>CARGANDO...</H1></div>
            <div id="title" class="window"><h1>HANGMAN</h1><p>PRESIONA CUALQUIER TECLA PARA CONTINUAR</p></div>
            <div id="profiles" class="window"><header class="telemetry-header"><span>HANGMAN :: SELECT PROFILE</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span><button class="settings-button" data-menu-id="settingsMenuProfiles">&#9881;</button><div id="settingsMenuProfiles" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><h2>PERFILES DE USUARIO</h2><ul id="profilesList"></ul><button id="goToPlayerCreateButton" class="interactive-button">CREAR NUEVO PERFIL</button></div><footer class="telemetry-footer">BUILD: v4.4.0-r37</footer></div>
            <div id="player" class="window"><header class="telemetry-header"><span>HANGMAN :: CREATE PROFILE</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span><button class="settings-button" data-menu-id="settingsMenuPlayer">&#9881;</button><div id="settingsMenuPlayer" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><h2>NUEVO JUGADOR</h2><div id="playerNameDisplay">_</div><div id="virtualKeyboard"></div><div style="display: flex; gap: 16px; margin-top: 16px;"><button id="cancelPlayerButton">CANCELAR</button></div></div><footer class="telemetry-footer">BUILD: v4.4.0-r37</footer></div>
            <div id="mainMenu" class="window"><header class="telemetry-header"><span>HANGMAN :: MAIN MENU</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span><button class="settings-button" data-menu-id="settingsMenuMain">&#9881;</button><div id="settingsMenuMain" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><h2 id="mainMenuHeader"></h2><div id="levelGrid"></div><button id="backToProfilesButton" style="margin-top: 16px;">VOLVER A PERFILES</button></div><footer class="telemetry-footer">BUILD: v4.4.0-r37</footer></div>
            <div id="game" class="window"><header class="telemetry-header"><span>HANGMAN :: GAME ACTIVE</span><div class="telemetry-group"><div class="telemetry-bars"><div class="telemetry-bar cpu"></div></div><div class="telemetry-bars"><div class="telemetry-bar mem"></div></div><button class="settings-button" data-menu-id="settingsMenuGame">&#9881;</button><div id="settingsMenuGame" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><div id="glitch-wrapper"><div id="holographic-panel"><h2>DESCIFRAR T&Eacute;RMINO</h2><div id="mistakesDisplay"></div><p id="gameDefinition"></p><div id="wordDisplay"></div><div id="gameKeyboard"></div></div></div></div><footer class="telemetry-footer">BUILD: v4.4.0-r37</footer></div>
            <div id="victory" class="window"><div class="ascii-art-container"></div><h1 style="color: var(--color-success);">N&Uacute;CLEO ESTABLE</h1><h2>VICTORIA</h2><p>HAS ADIVINADO EL T&Eacute;RMINO CORRECTAMENTE.</p><button id="victoryToMenuButton">VOLVER AL MEN&Uacute;</button></div>
            <div id="gameOver" class="window"><div class="ascii-art-container"></div><h1 style="color: var(--color-error);">FALLO CR&Iacute;TICO</h1><h2>DERROTA</h2><p id="gameOverCorrectWord"></p><button id="gameOverToMenuButton">REINTENTAR DESDE EL MEN&Uacute;</button></div>
            <div id="fullscreenOverlay" class="window" style="z-index: 999; background-color: rgba(0,0,0,0.95);"><h2>MODO PANTALLA COMPLETA REQUERIDO</h2><p>PARA UNA EXPERIENCIA &Oacute;PTIMA, EL SISTEMA REQUIERE OPERAR EN MODO DE PANTALLA COMPLETA.</p><button id="reEnterFullscreenButton">REACTIVAR</button></div>
        </main>
        <div id="undo-notification">
            <span>PERFIL BORRADO</span>
            <button id="undo-button">DESHACER</button>
        </div>
    </div>
    <script>
        (function() {
            'use strict';
            function createEventBus() {
                var listeners = {};
                return { on: function(eventName, callback) { if (!listeners[eventName]) { listeners[eventName] = []; } listeners[eventName].push(callback); }, off: function(eventName, callback) { if (!listeners[eventName]) return; listeners[eventName] = listeners[eventName].filter(function(cb) { return cb !== callback; }); }, emit: function(eventName, data) { if (!listeners[eventName]) return; listeners[eventName].forEach(function(callback) { callback(data); }); } };
            }
            var EventBus = createEventBus();
            var AudioManager = { audioCtx: null, init: function() { if (!this.audioCtx && (window.AudioContext || window.webkitAudioContext)) { try { this.audioCtx = new (window.AudioContext || window.webkitAudioContext)(); } catch(e) { console.error("[AUDIO] Web Audio API not supported.", e); } } }, playSound: function(type) { if (!state.settings.soundEnabled || !this.audioCtx) return; var osc = this.audioCtx.createOscillator(); var gain = this.audioCtx.createGain(); osc.connect(gain); gain.connect(this.audioCtx.destination); var now = this.audioCtx.currentTime; switch(type) { case 'tick': osc.type = 'triangle'; osc.frequency.setValueAtTime(880, now); gain.gain.setValueAtTime(0.3, now); gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.1); osc.start(now); osc.stop(now + 0.1); break; case 'success': osc.type = 'sine'; osc.frequency.setValueAtTime(523.25, now); osc.frequency.exponentialRampToValueAtTime(1046.50, now + 0.1); gain.gain.setValueAtTime(0.2, now); gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.1); osc.start(now); osc.stop(now + 0.1); break; case 'error': osc.type = 'square'; osc.frequency.setValueAtTime(164.81, now); osc.frequency.exponentialRampToValueAtTime(73.42, now + 0.2); gain.gain.setValueAtTime(0.2, now); gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.2); osc.start(now); osc.stop(now + 0.2); break; case 'navigate': osc.type = 'sine'; osc.frequency.setValueAtTime(330, now); osc.frequency.exponentialRampToValueAtTime(660, now + 0.15); gain.gain.setValueAtTime(0.2, now); gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.15); osc.start(now); osc.stop(now + 0.15); break; } } };
            var CommandManager = { undoStack: [], execute: function(command) { command.execute(); this.undoStack.push(command); EventBus.emit('command:executed', { commandType: command.name }); }, undo: function() { var command = this.undoStack.pop(); if (command) { command.undo(); EventBus.emit('command:undone', { commandType: command.name }); } } };
            function DeleteProfileCommand(profileName) { this.name = 'DeleteProfile'; this.profileName = profileName; this.profileData = JSON.parse(JSON.stringify(state.profiles[profileName])); this.execute = function() { delete state.profiles[this.profileName]; saveProfilesToStorage(); renderProfiles(); }; this.undo = function() { state.profiles[this.profileName] = this.profileData; saveProfilesToStorage(); renderProfiles(); }; }
            var state = { currentWindow: 'preload', activeProfile: null, profiles: {}, newPlayerName: '', isShiftActive: false, settings: { soundEnabled: true, paletteIndex: 0 }, game: { prngState: 0, sessionPlayedWords: { facil: [], medio: [], dificil: [] }, currentDifficulty: null, difficultyTiers: { facil: [ { term: 'RAM', definition: 'MEMORIA VOL\u00c1TIL DE ACCESO ALEATORIO.' }, { term: 'ROM', definition: 'MEMORIA NO VOL\u00c1TIL DE SOLO LECTURA.' }, { term: 'HDD', definition: 'DISCO DURO MEC\u00c1NICO CON PLATOS GIRATORIOS.' }, { term: 'SSD', definition: 'UNIDAD DE ESTADO S\u00d3LIDO SIN PARTES M\u00d3VILES.' }, { term: 'USB', definition: 'EST\u00c1NDAR DE BUS SERIE UNIVERSAL PARA CONECTAR DISPOSITIVOS.' }, { term: 'RAID', definition: 'CONJUNTO REDUNDANTE DE DISCOS INDEPENDIENTES.' }, { term: 'NUBE', definition: 'ALMACENAMIENTO DE DATOS EN SERVIDORES REMOTOS.' }, { term: 'BIOS', definition: 'SISTEMA B\u00c1SICO DE ENTRADA/SALIDA EN LA PLACA BASE.' }, { term: 'BIT', definition: 'LA UNIDAD DE INFORMACI\u00d3N M\u00c1S PEQUE\u00d1A.' }, { term: 'BYTE', definition: 'CONJUNTO DE 8 BITS QUE REPRESENTA UN CAR\u00c1CTER.' }, { term: 'LAN', definition: 'RED DE \u00c1REA LOCAL.' }, { term: 'WAN', definition: 'RED DE \u00c1REA AMPLIA.' }, { term: 'IP', definition: 'DIRECCI\u00d3N DE PROTOCOLO DE INTERNET.' }, { term: 'MAC', definition: 'DIRECCI\u00d3N DE CONTROL DE ACCESO AL MEDIO.' }, { term: 'DNS', definition: 'SISTEMA DE NOMBRES DE DOMINIO.' }, { term: 'FTP', definition: 'PROTOCOLO DE TRANSFERENCIA DE ARCHIVOS.' }, { term: 'CPU', definition: 'UNIDAD CENTRAL DE PROCESAMIENTO.' }, { term: 'GPU', definition: 'UNIDAD DE PROCESAMIENTO GR\u00c1FICO.' }, { term: 'OS', definition: 'SISTEMA OPERATIVO.' }, { term: 'GUI', definition: 'INTERFAZ GR\u00c1FICA DE USUARIO.' }, { term: 'API', definition: 'INTERFAZ DE PROGRAMACI\u00d3N DE APLICACIONES.' }, { term: 'JSON', definition: 'NOTACI\u00d3N DE OBJETOS DE JAVASCRIPT.' }, { term: 'XML', definition: 'LENGUAJE DE MARCADO EXTENSIBLE.' }, { term: 'HTML', definition: 'LENGUAJE DE MARCADO DE HIPERTEXTO.' }, { term: 'CSS', definition: 'HOJAS DE ESTILO EN CASCADA.' }, { term: 'BUG', definition: 'ERROR O FALLO EN UN PROGRAMA.' }, { term: 'LOG', definition: 'REGISTRO DE EVENTOS DE UN SISTEMA.' }, { term: 'WIFI', definition: 'TECNOLOG\u00cdA DE RED INAL\u00c1MBRICA.' }, { term: 'URL', definition: 'LOCALIZADOR UNIFORME DE RECURSOS.' }, { term: 'PING', definition: 'UTILIDAD PARA PROBAR LA CONECTIVIDAD DE RED.' } ], medio: [ { term: 'CACHE', definition: 'MEMORIA R\u00c1PIDA PARA DATOS DE ACCESO FRECUENTE.' }, { term: 'SECTOR', definition: 'LA SUBDIVISI\u00d3N M\u00c1S PEQUE\u00d1A DE UNA PISTA EN UN DISCO.' }, { term: 'CLUSTER', definition: 'CONJUNTO DE SECTORES DE DISCO TRATADOS COMO UNA UNIDAD.' }, { term: 'BACKUP', definition: 'COPIA DE SEGURIDAD DE DATOS PARA RESTAURACI\u00d3N.' }, { term: 'MEMORIA', definition: 'COMPONENTE QUE ALMACENA DATOS PARA ACCESO R\u00c1PIDO POR LA CPU.' }, { term: 'VOLUMEN', definition: 'UN \u00c1REA DE ALMACENAMIENTO \u00daNICA Y ACCESIBLE CON UN SISTEMA DE ARCHIVOS.' }, { term: 'VIRTUAL', definition: 'MEMORIA QUE SIMULA SER RAM USANDO ESPACIO EN DISCO.' }, { term: 'HIBRIDO', definition: 'UNIDAD DE ALMACENAMIENTO QUE COMBINA HDD Y SSD.' }, { term: 'SATA', definition: 'INTERFAZ PARA CONECTAR DISPOSITIVOS DE ALMACENAMIENTO MASIVO.' }, { term: 'FAT32', definition: 'UN SISTEMA DE ARCHIVOS COM\u00daN PARA UNIDADES EXTRA\u00cdBLES.' }, { term: 'KERNEL', definition: 'N\u00daCLEO DE UN SISTEMA OPERATIVO.' }, { term: 'DRIVER', definition: 'SOFTWARE QUE CONTROLA UN DISPOSITIVO DE HARDWARE.' }, { term: 'ROUTER', definition: 'DISPOSITIVO QUE ENV\u00cdA PAQUETES DE DATOS ENTRE REDES.' }, { term: 'SWITCH', definition: 'DISPOSITIVO QUE CONECTA DISPOSITIVOS EN UNA RED.' }, { term: 'MODEM', definition: 'DISPOSITIVO QUE MODULA Y DEMODULA SE\u00d1ALES.' }, { term: 'CLIENTE', definition: 'APLICACI\u00d3N O SISTEMA QUE ACCEDE A UN SERVICIO EN UN SERVIDOR.' }, { term: 'SERVIDOR', definition: 'SISTEMA QUE PROPORCIONA SERVICIOS A CLIENTES.' }, { term: 'FIREWALL', definition: 'SISTEMA DE SEGURIDAD QUE CONTROLA EL TR\u00c1FICO DE RED.' }, { term: 'CODIGO', definition: 'CONJUNTO DE INSTRUCCIONES PARA UN ORDENADOR.' }, { term: 'SCRIPT', definition: 'PROGRAMA QUE SE INTERPRETA EN LUGAR DE COMPILARSE.' }, { term: 'COMPILAR', definition: 'TRADUCIR C\u00d3DIGO FUENTE A C\u00d3DIGO M\u00c1QUINA.' }, { term: 'VARIABLE', definition: 'ESPACIO EN MEMORIA CON UN NOMBRE Y UN VALOR.' }, { term: 'FUNCION', definition: 'BLOQUE DE C\u00d3DIGO REUTILIZABLE QUE REALIZA UNA TAREA.' }, { term: 'ALGORITMO', definition: 'CONJUNTO DE PASOS PARA RESOLVER UN PROBLEMA.' }, { term: 'FRAMEWORK', definition: 'CONJUNTO DE HERRAMIENTAS Y LIBRER\u00cdAS PARA DESARROLLAR SOFTWARE.' }, { term: 'LIBRERIA', definition: 'COLECCI\u00d3N DE FUNCIONES Y RUTINAS PREESCRITAS.' }, { term: 'BOOLEANO', definition: 'TIPO DE DATO CON VALORES VERDADERO O FALSO.' }, { term: 'ITERAR', definition: 'REPETIR UN PROCESO O CONJUNTO DE INSTRUCCIONES.' }, { term: 'RECURSION', definition: 'T\u00c9CNICA DONDE UNA FUNCI\u00d3N SE LLAMA A S\u00cd MISMA.' }, { term: 'DEPURAR', definition: 'PROCESO DE ENCONTRAR Y CORREGIR ERRORES.' } ], dificil: [ { term: 'PARTICION', definition: 'DIVISI\u00d3N L\u00d3GICA DE UNA UNIDAD DE ALMACENAMIENTO F\u00cdSICA.' }, { term: 'VOLATIL', definition: 'TIPO DE MEMORIA QUE PIERDE SUS DATOS CUANDO SE CORTA LA ENERG\u00cdA.' }, { term: 'SECUENCIAL', definition: 'ACCESO A DATOS QUE SE REALIZA EN UN ORDEN PREDETERMINADO.' }, { term: 'PERSISTENCIA', definition: 'LA CARACTER\u00cdSTICA DE LOS DATOS QUE SOBREVIVEN DESPU\u00c9S DE QUE EL PROCESO TERMINA.' }, { term: 'REDUNDANCIA', definition: 'DUPLICACI\u00d3N DE COMPONENTES O DATOS CR\u00cdTICOS PARA AUMENTAR LA FIABILIDAD.' }, { term: 'ENCRIPTACION', definition: 'PROCESO DE CODIFICAR DATOS PARA QUE SOLO PARTES AUTORIZADAS PUEDAN LEERLOS.' }, { term: 'INSTANTANEA', definition: 'COPIA DEL ESTADO DE UN SISTEMA EN UN MOMENTO DETERMINADO, TAMBI\u00c9N LLAMADA SNAPSHOT.' }, { term: 'JERARQUICO', definition: 'MODELO DE SISTEMA DE ARCHIVOS QUE ORGANIZA DATOS EN UNA ESTRUCTURA DE \u00c1RBOL.' }, { term: 'DESFRAGMENTAR', definition: 'PROCESO DE REORGANIZAR LOS DATOS EN UN DISCO PARA QUE LAS PARTES DE CADA ARCHIVO EST\u00c9N CONTIGUAS.' }, { term: 'ALMACENAMIENTO', definition: 'RETENCI\u00d3N DE DATOS RECUPERABLES EN MEDIOS DIGITALES.' }, { term: 'VIRTUALIZACION', definition: 'CREACI\u00d3N DE UNA VERSI\u00d3N VIRTUAL DE ALGO, COMO UN SERVIDOR O SISTEMA OPERATIVO.' }, { term: 'CONTENEDOR', definition: 'UNIDAD EST\u00c1NDAR DE SOFTWARE QUE EMPAQUETA C\u00d3DIGO Y SUS DEPENDENCIAS.' }, { term: 'ORQUESTACION', definition: 'AUTOMATIZACI\u00d3N DE LA GESTI\u00d3N, COORDINACI\u00d3N Y DESPLIEGE DE CONTENEDORES.' }, { term: 'MICROSERVICIOS', definition: 'ARQUITECTURA DONDE UNA APLICACI\u00d3N SE COMPONE DE PEQUE\u00d1OS SERVICIOS INDEPENDIENTES.' }, { term: 'AUTENTICACION', definition: 'PROCESO DE VERIFICAR LA IDENTIDAD DE UN USUARIO.' }, { term: 'AUTORIZACION', definition: 'PROCESO DE OTORGAR PERMISOS A UN USUARIO AUTENTICADO.' }, { term: 'PROTOCOLO', definition: 'CONJUNTO DE REGLAS QUE GOBIERNAN LA COMUNICACI\u00d3N DE DATOS.' }, { term: 'LATENCIA', definition: 'RETRASO EN LA TRANSMISI\u00d3N DE DATOS EN UNA RED.' }, { term: 'ANCHO DE BANDA', definition: 'CAPACIDAD M\u00c1XIMA DE TRANSFERENCIA DE DATOS DE UNA RED.' }, { term: 'POLIMORFISMO', definition: 'CONCEPTO DE PROGRAMACI\u00d3N ORIENTADA A OBJETOS PARA PROCESAR OBJETOS DE FORMA DIFERENTE SEG\u00daN SU TIPO.' }, { term: 'HERENCIA', definition: 'MECANISMO POR EL CUAL UNA CLASE ADQUIERE PROPIEDADES DE OTRA CLASE.' }, { term: 'ENCAPSULACION', definition: 'OCULTACI\u00d3N DE LOS DETALLES INTERNOS DE UN OBJETO Y EXPOSICI\u00d3N DE UNA INTERFAZ P\u00daBLICA.' }, { term: 'ABSTRACCION', definition: 'PROCESO DE SIMPLIFICAR SISTEMAS COMPLEJOS MOSTRANDO SOLO LA INFORMACI\u00d3N RELEVANTE.' }, { term: 'COMPILADOR JIT', definition: 'COMPILADOR "JUST-IN-TIME" QUE COMPILA C\u00d3DIGO DURANTE LA EJECUCI\u00d3N.' }, { term: 'RECOLECCION DE BASURA', definition: 'FORMA DE GESTI\u00d3N AUTOM\u00c1TICA DE MEMORIA.' }, { term: 'HILO DE EJECUCION', definition: 'LA SECUENCIA M\u00c1S PEQUE\u00d1A DE INSTRUCCIONES PROGRAMADAS QUE PUEDE SER GESTIONADA DE FORMA INDEPENDIENTE.' }, { term: 'INTERBLOQUEO', definition: 'SITUACI\u00d3N EN LA QUE DOS O M\u00c1S PROCESOS SE BLOQUEAN MUTUAMENTE, ESPERANDO RECURSOS.' }, { term: 'SEMAFORO', definition: 'VARIABLE UTILIZADA PARA CONTROLAR EL ACCESO A UN RECURSO COM\u00daN POR M\u00daLTIPLES PROCESOS.' }, { term: 'CRIPTOGRAFIA', definition: 'PR\u00c1CTICA Y ESTUDIO DE T\u00c9CNICAS PARA LA COMUNICACI\u00d3N SEGURA.' }, { term: 'ESTEGANOGRAFIA', definition: 'T\u00c9CNICA DE OCULTAR MENSAJES DENTRO DE OTROS OBJETOS O ARCHIVOS.' } ] }, currentWord: '', currentDefinition: '', guessedLetters: [], mistakes: 0, maxMistakes: 6, isOver: false } };
            var windows = { preload: document.getElementById('preload'), title: document.getElementById('title'), profiles: document.getElementById('profiles'), player: document.getElementById('player'), mainMenu: document.getElementById('mainMenu'), game: document.getElementById('game'), victory: document.getElementById('victory'), gameOver: document.getElementById('gameOver'), fullscreenOverlay: document.getElementById('fullscreenOverlay') };
            var ui = { levelGrid: document.getElementById('levelGrid'), profilesList: document.getElementById('profilesList'), goToPlayerCreateButton: document.getElementById('goToPlayerCreateButton'), mainMenuHeader: document.getElementById('mainMenuHeader'), backToProfilesButton: document.getElementById('backToProfilesButton'), playerNameDisplay: document.getElementById('playerNameDisplay'), virtualKeyboard: document.getElementById('virtualKeyboard'), cancelPlayerButton: document.getElementById('cancelPlayerButton'), gameDefinition: document.getElementById('gameDefinition'), wordDisplay: document.getElementById('wordDisplay'), gameKeyboard: document.getElementById('gameKeyboard'), victoryToMenuButton: document.getElementById('victoryToMenuButton'), gameOverToMenuButton: document.getElementById('gameOverToMenuButton'), gameOverCorrectWord: document.getElementById('gameOverCorrectWord'), reEnterFullscreenButton: document.getElementById('reEnterFullscreenButton'), holographicPanel: document.getElementById('holographic-panel'), mistakesDisplay: document.getElementById('mistakesDisplay'), glitchWrapper: document.getElementById('glitch-wrapper'), undoNotification: document.getElementById('undo-notification'), undoButton: document.getElementById('undo-button') };
            var PLAYER_KEYBOARD_LAYOUT = ['Q','W','E','R','T','Y','U','Backspace','A','S','D','F','G','H','Enter','I','J','K','L','M','\u00d1','O','P','Shift','Z','X','C','V','B','N'];
            var GAME_KEYBOARD_CHARS = 'ABCDEFGHIJKLMN\u00d1OPQRSTUVWXYZ';
            var PROFILES_KEY = 'analyzer:profiles';
            var SETTINGS_KEY = 'analyzer:settings';
            var PALETTES = { 'CIAN': '#00FFFF', 'FUEGO': '#FF4500', 'JUNGLA': '#228B22', 'GALAXIA': '#8A2BE2', 'DORADO': '#FFD700', 'OCEANO': '#00008B', 'NEON': '#39FF14' };
            var PALETTE_KEYS = Object.keys(PALETTES);
            var RANK_NAMES = ['RECLUTA', 'APRENDIZ', 'PRIVADO', 'CORPORAL', 'SARGENTO', 'TENIENTE', 'CAPITÁN', 'MAYOR', 'CORONEL', 'GENERAL'];

            function saveSettings() { try { localStorage.setItem(SETTINGS_KEY, JSON.stringify(state.settings)); } catch (e) { console.error('[ERR][STORAGE] FALLO AL GUARDAR CONFIGURACIÓN.', e); } }
            function loadSettings() { try { var stored = JSON.parse(localStorage.getItem(SETTINGS_KEY)); if(stored) { state.settings = stored; } } catch (e) { console.error('[ERR][STORAGE] FALLO AL CARGAR CONFIGURACIÓN.', e); } }
            function saveProfilesToStorage() { try { localStorage.setItem(PROFILES_KEY, JSON.stringify(state.profiles)); } catch (e) { console.error('[ERR][STORAGE] FALLO AL GUARDAR PERFILES.', e); } }
            function loadProfilesFromStorage() { try { var d = JSON.parse(localStorage.getItem(PROFILES_KEY)); if (!d) { state.profiles = {}; return; } var p = {}; var n = Array.isArray(d) ? d : Object.keys(d); n.forEach(function(pn) { var op = Array.isArray(d) ? {} : d[pn]; p[pn] = { solvedWords: op.solvedWords || { facil: [], medio: [], dificil: [] }, perfectRuns: op.perfectRuns || { facil: false, medio: false, dificil: false }, ranks: op.ranks || { facil: 0, medio: 0, dificil: 0 }, globalRank: op.globalRank || 0 }; }); state.profiles = p; saveProfilesToStorage(); } catch (e) { console.error('[ERR][STORAGE] FALLO AL CARGAR PERFILES.', e); state.profiles = {}; } }
            
            var isTransitioning = false;
            function showWindow(newWindowId) { if (isTransitioning) return; var oldWindow = document.querySelector('.window.active'); var newWindow = windows[newWindowId]; if (oldWindow === newWindow) return; isTransitioning = true; function transitionEnd() { if (oldWindow) { oldWindow.classList.remove('active', 'glitching-out'); } newWindow.classList.add('active'); newWindow.classList.add('glitching-in'); state.currentWindow = newWindowId; setTimeout(function() { newWindow.classList.remove('glitching-in'); isTransitioning = false; }, 350); } if (oldWindow) { oldWindow.classList.add('glitching-out'); setTimeout(transitionEnd, 350); } else { transitionEnd(); } }
            function requestFullscreen() { var e = document.documentElement; if (e.requestFullscreen) e.requestFullscreen(); else if (e.mozRequestFullScreen) e.mozRequestFullScreen(); else if (e.webkitRequestFullscreen) e.webkitRequestFullscreen(); else if (e.msRequestFullscreen) e.msRequestFullscreen(); }
            function handleFullscreenChange() { var isFs = document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement; if (!isFs && state.currentWindow !== 'preload' && state.currentWindow !== 'title') { windows.fullscreenOverlay.classList.add('active'); } else { windows.fullscreenOverlay.classList.remove('active'); } }
            function renderPlayerKeyboard() { ui.virtualKeyboard.innerHTML = ''; PLAYER_KEYBOARD_LAYOUT.forEach(function(k) { var e = document.createElement('button'); e.className = 'interactive-button key'; e.setAttribute('data-key', k); var t = k; if (k === 'Backspace') t = '<-'; else if (k === 'Enter') t = 'ENTR'; else if (k === 'Shift') { t = 'SHFT'; if (state.isShiftActive) e.classList.add('active'); } e.textContent = t; ui.virtualKeyboard.appendChild(e); }); }
            function renderProfiles() { ui.profilesList.innerHTML = ''; Object.keys(state.profiles).forEach(function(pn) { var li = document.createElement('li'); li.className = 'profile-entry'; var pb = document.createElement('button'); pb.className = 'interactive-button profile-button'; pb.textContent = pn; pb.setAttribute('data-profile-name', pn); var db = document.createElement('button'); db.className = 'delete-button'; db.textContent = 'X'; db.setAttribute('data-profile-name', pn); li.appendChild(pb); li.appendChild(db); ui.profilesList.appendChild(li); }); }
            
            function renderLevelProgress() { if (!state.activeProfile || !state.profiles[state.activeProfile]) return; var p = state.profiles[state.activeProfile]; document.querySelectorAll('#levelGrid button').forEach(function(b) { var d = b.getAttribute('data-difficulty'); var rankContainer = b.querySelector('.rank-icon-container'); var title = b.querySelector('.level-title'); var c = b.querySelector('.progress-cubes-container'), i = b.querySelector('.perfect-run-icon'); if (!d || !c || !i || !rankContainer || !title) return; var solvedCount = p.solvedWords[d] ? p.solvedWords[d].length : 0; var rankIndex = Math.min(Math.floor(solvedCount / 3), RANK_NAMES.length - 1); p.ranks[d] = rankIndex; title.textContent = 'NIVEL ' + d.toUpperCase(); rankContainer.innerHTML = ''; var svgTemplate = document.getElementById('rank-glyph-' + rankIndex); if (svgTemplate) { var svgClone = svgTemplate.cloneNode(true); svgClone.classList.add('rank-' + rankIndex); rankContainer.appendChild(svgClone); } c.innerHTML = ''; for (var j = 0; j < solvedCount; j++) { var cube = document.createElement('div'); cube.className = 'progress-cube'; if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) { cube.style.animation = 'cube-flicker 4s infinite'; cube.style.animationDelay = '-' + Math.random() * 4 + 's'; } c.appendChild(cube); } if (p.perfectRuns && p.perfectRuns[d]) { i.textContent = '[★]'; i.classList.add('achieved'); } else { i.textContent = ''; i.classList.remove('achieved'); } }); p.globalRank = Math.floor((p.ranks.facil + p.ranks.medio + p.ranks.dificil) / 3); EventBus.emit('profile:updated'); }
            function populateLevelGrid() { ui.levelGrid.innerHTML = ''; Object.keys(state.game.difficultyTiers).forEach(function(d) { var b = document.createElement('button'); b.className = 'interactive-button'; b.setAttribute('data-difficulty', d); var c = document.createElement('div'); c.className = 'level-button-content'; var rankContainer = document.createElement('div'); rankContainer.className = 'rank-icon-container'; var tc = document.createElement('div'); tc.className = 'level-title-container'; var t = document.createElement('span'); t.className = 'level-title'; var i = document.createElement('span'); i.className = 'perfect-run-icon'; tc.appendChild(t); tc.appendChild(i); var cubes = document.createElement('div'); cubes.className = 'progress-cubes-container'; c.appendChild(rankContainer); c.appendChild(tc); c.appendChild(cubes); b.appendChild(c); ui.levelGrid.appendChild(b); }); }
            function applyPalette(index) { var key = PALETTE_KEYS[index]; if (key) { document.body.style.setProperty('--color-accent-primary', PALETTES[key]); } }
            function updateSoundToggleButtons() { var text = 'SONIDO: ' + (state.settings.soundEnabled ? 'ON' : 'OFF'); document.querySelectorAll('.sound-toggle-button').forEach(function(btn) { btn.textContent = text; }); }
            function renderPaletteSubMenus() { document.querySelectorAll('.palette-submenu').forEach(function(submenu) { submenu.innerHTML = ''; PALETTE_KEYS.forEach(function(key, index) { var button = document.createElement('button'); button.textContent = key; button.setAttribute('data-palette-index', index); button.style.color = PALETTES[key]; submenu.appendChild(button); }); }); }
            var GameManager = { xorshift32: function(s) { var x = s; x ^= x << 13; x ^= x >> 17; x ^= x << 5; return x; }, getRandomInt: function(m) { state.game.prngState = this.xorshift32(state.game.prngState); return (state.game.prngState & 0x7FFFFFFF) % m; }, startGame: function(d) { var wl = state.game.difficultyTiers[d], pw = state.game.sessionPlayedWords[d], aw = wl.filter(function(w) { return pw.indexOf(w.term) === -1; }); if (aw.length === 0) { state.game.sessionPlayedWords[d] = []; aw = wl; } var ri = this.getRandomInt(aw.length), gd = aw[ri]; state.game.sessionPlayedWords[d].push(gd.term); state.game.currentWord = gd.term; state.game.currentDifficulty = d; state.game.currentDefinition = gd.definition; state.game.guessedLetters = []; state.game.mistakes = 0; state.game.isOver = false; ui.gameDefinition.textContent = state.game.currentDefinition; this.renderWordDisplay(); this.renderGameKeyboard(); this.renderMistakesDisplay(); EventBus.emit('system:requestNavigation', { windowId: 'game' }); }, handleGuess: function(l) { if (state.game.isOver || state.game.guessedLetters.indexOf(l) !== -1) return; state.game.guessedLetters.push(l); var c = state.game.currentWord.indexOf(l) !== -1; if (c) { AudioManager.playSound('success'); this.renderWordDisplay(); } else { state.game.mistakes++; state.profiles[state.activeProfile].perfectRuns[state.game.currentDifficulty] = false; AudioManager.playSound('error'); this.renderMistakesDisplay(); if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) { ui.glitchWrapper.classList.add('glitch-active'); ui.holographicPanel.classList.add('error-flash'); setTimeout(function() { ui.glitchWrapper.classList.remove('glitch-active'); ui.holographicPanel.classList.remove('error-flash'); }, 300); } else { document.body.style.backgroundColor = 'var(--color-error)'; setTimeout(function(){ document.body.style.backgroundColor = 'var(--color-bg-primary)'; }, 150); } } this.renderGameKeyboard(); this.checkGameState(); }, checkGameState: function() { var s = true; for(var i=0; i<state.game.currentWord.length; i++) { var c = state.game.currentWord[i]; if(c !== ' ' && state.game.guessedLetters.indexOf(c) === -1) { s = false; break; } } if (s) { this.endGame(true); } else if (state.game.mistakes >= state.game.maxMistakes) { this.endGame(false); } }, endGame: function(w) { state.game.isOver = true; var p = state.profiles[state.activeProfile], cd = state.game.currentDifficulty; if (w) { var sl = p.solvedWords[cd]; if (sl.indexOf(state.game.currentWord) === -1) { sl.push(state.game.currentWord); } p.ranks[cd] = Math.min(Math.floor(sl.length / 3), RANK_NAMES.length - 1); p.globalRank = Math.floor((p.ranks.facil + p.ranks.medio + p.ranks.dificil) / 3); if (state.game.mistakes === 0) { p.perfectRuns[cd] = true; } else { p.perfectRuns[cd] = false; } } else { p.perfectRuns[cd] = false; } saveProfilesToStorage(); setTimeout(function() { if (w) { EventBus.emit('game:victory'); } else { EventBus.emit('game:defeat', { correctWord: state.game.currentWord }); } }, 500); }, renderWordDisplay: function() { ui.wordDisplay.innerHTML = ''; state.game.currentWord.split('').forEach(function(c) { var d = document.createElement('div'); d.className = 'word-letter'; if (c === ' ') { d.classList.add('space'); } else { d.textContent = state.game.guessedLetters.indexOf(c) !== -1 ? c : ''; } ui.wordDisplay.appendChild(d); }); }, renderGameKeyboard: function() { ui.gameKeyboard.innerHTML = ''; GAME_KEYBOARD_CHARS.split('').forEach(function(c) { var b = document.createElement('button'); b.className = 'interactive-button key'; b.textContent = c; b.setAttribute('data-key', c); if (state.game.guessedLetters.indexOf(c) !== -1) { b.disabled = true; } ui.gameKeyboard.appendChild(b); }); }, renderMistakesDisplay: function() { ui.mistakesDisplay.innerHTML = ''; for (var i = 0; i < state.game.maxMistakes; i++) { var s = document.createElement('div'); s.className = 'mistake-segment'; if (i < state.game.mistakes) { s.classList.add('filled'); } ui.mistakesDisplay.appendChild(s); } } };
            document.addEventListener('DOMContentLoaded', function() {
                console.log('[BOOT][INFO] INICIALIZANDO HANGMAN v4.4.0-r37 (SVG_RANK_SYSTEM)...');
                state.game.prngState = new Date().getTime();
                loadSettings(); loadProfilesFromStorage(); applyPalette(state.settings.paletteIndex); updateSoundToggleButtons(); populateLevelGrid(); renderPlayerKeyboard(); renderPaletteSubMenus();
                var undoTimeout;
                function advanceToProfiles() { AudioManager.init(); EventBus.emit('system:requestNavigation', { windowId: 'profiles', requestFullscreen: true }); }
                windows.title.addEventListener('click', advanceToProfiles); document.addEventListener('keydown', advanceToProfiles, { once: true });
                ui.reEnterFullscreenButton.addEventListener('click', function() { EventBus.emit('system:requestFullscreen'); });
                ui.goToPlayerCreateButton.addEventListener('click', function() { EventBus.emit('system:requestNavigation', { windowId: 'player' }); });
                ui.cancelPlayerButton.addEventListener('click', function() { EventBus.emit('system:requestNavigation', { windowId: 'profiles' }); });
                ui.backToProfilesButton.addEventListener('click', function() { EventBus.emit('profile:clearActive'); });
                ui.victoryToMenuButton.addEventListener('click', function() { EventBus.emit('system:requestNavigation', { windowId: 'mainMenu', fromVictory: true }); });
                ui.gameOverToMenuButton.addEventListener('click', function() { EventBus.emit('system:requestNavigation', { windowId: 'mainMenu' }); });
                ui.profilesList.addEventListener('click', function(e) { var n = e.target.getAttribute('data-profile-name'); if (!n) return; if (e.target.classList.contains('profile-button')) { EventBus.emit('profile:selected', { profileName: n }); } else if (e.target.classList.contains('delete-button')) { EventBus.emit('profile:deleted', { profileName: n }); } });
                ui.virtualKeyboard.addEventListener('click', function(e) { var k = e.target.getAttribute('data-key'); if (!k || !e.target.classList.contains('key')) return; EventBus.emit('player:input', { key: k }); });
                ui.levelGrid.addEventListener('click', function(e) { var b = e.target.closest('button[data-difficulty]'); if (b) { EventBus.emit('game:start', { difficulty: b.getAttribute('data-difficulty') }); } });
                ui.gameKeyboard.addEventListener('click', function(e) { if (e.target.hasAttribute('data-key')) { AudioManager.playSound('tick'); EventBus.emit('game:guess', { letter: e.target.getAttribute('data-key') }); } });
                ui.undoButton.addEventListener('click', function() { CommandManager.undo(); clearTimeout(undoTimeout); ui.undoNotification.classList.remove('visible'); });
                document.querySelectorAll('.settings-button').forEach(function(b) { b.addEventListener('click', function(e) { e.stopPropagation(); var menu = document.getElementById(e.target.getAttribute('data-menu-id')); var isActive = menu.classList.contains('active'); document.querySelectorAll('.settings-menu').forEach(function(m) { m.classList.remove('active'); }); if (!isActive) { menu.classList.add('active'); } }); });
                document.querySelectorAll('.sound-toggle-button').forEach(function(b) { b.addEventListener('click', function() { state.settings.soundEnabled = !state.settings.soundEnabled; updateSoundToggleButtons(); saveSettings(); }); });
                document.querySelectorAll('.palette-toggle-button').forEach(function(b) { b.addEventListener('click', function(e) { e.stopPropagation(); document.querySelectorAll('.palette-container').forEach(function(pc){ if(pc !== e.target.parentElement) pc.classList.remove('open'); }); e.target.parentElement.classList.toggle('open'); }); });
                document.querySelectorAll('.palette-submenu').forEach(function(s) { s.addEventListener('click', function(e) { if(e.target.hasAttribute('data-palette-index')) { state.settings.paletteIndex = parseInt(e.target.getAttribute('data-palette-index'), 10); applyPalette(state.settings.paletteIndex); saveSettings(); } }); });
                document.querySelectorAll('.close-session-button').forEach(function(b) { b.addEventListener('click', function() { EventBus.emit('system:closeSession'); }); });
                document.body.addEventListener('click', function() { document.querySelectorAll('.settings-menu.active, .palette-container.open').forEach(function(m) { m.classList.remove('active', 'open'); }); });
                if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) { document.body.addEventListener('mousemove', function(e) { var x = (e.clientX / window.innerWidth) - 0.5, y = (e.clientY / window.innerHeight) - 0.5, rx = y * -5, ry = x * 5; if(ui.holographicPanel) ui.holographicPanel.style.transform = 'rotateX(' + (10 + rx) + 'deg) rotateY(' + ry + 'deg)'; }); }
                document.addEventListener('fullscreenchange', handleFullscreenChange); document.addEventListener('webkitfullscreenchange', handleFullscreenChange); document.addEventListener('mozfullscreenchange', handleFullscreenChange); document.addEventListener('MSFullscreenChange', handleFullscreenChange);
                EventBus.on('system:requestNavigation', function(d) { AudioManager.playSound('navigate'); if(d.requestFullscreen) requestFullscreen(); if(d.fromVictory) renderLevelProgress(); if(d.windowId === 'profiles') renderProfiles(); showWindow(d.windowId); });
                EventBus.on('system:requestFullscreen', function() { AudioManager.playSound('navigate'); requestFullscreen(); });
                EventBus.on('system:closeSession', function() { AudioManager.playSound('navigate'); state.activeProfile = null; document.querySelectorAll('.settings-menu').forEach(function(m) { m.classList.remove('active'); }); showWindow('profiles'); });
                EventBus.on('profile:selected', function(d) { AudioManager.playSound('navigate'); state.activeProfile = d.profileName; EventBus.emit('profile:updated'); renderLevelProgress(); showWindow('mainMenu'); });
                EventBus.on('profile:deleted', function(d) { var command = new DeleteProfileCommand(d.profileName); CommandManager.execute(command); });
                EventBus.on('profile:clearActive', function() { AudioManager.playSound('navigate'); state.activeProfile = null; showWindow('profiles'); });
                EventBus.on('profile:updated', function() { var profile = state.profiles[state.activeProfile]; if (!profile) return; var globalRankIndex = profile.globalRank || 0; var svgTemplate = document.getElementById('rank-glyph-' + globalRankIndex); ui.mainMenuHeader.innerHTML = 'JUGADOR: ' + state.activeProfile; if(svgTemplate) { var iconContainer = document.createElement('div'); iconContainer.className = 'rank-icon-container'; var svgClone = svgTemplate.cloneNode(true); svgClone.classList.add('rank-' + globalRankIndex); iconContainer.appendChild(svgClone); ui.mainMenuHeader.appendChild(iconContainer); }});
                EventBus.on('player:input', function(d) { AudioManager.playSound('tick'); if (d.key === 'Backspace') { state.newPlayerName = state.newPlayerName.slice(0, -1); } else if (d.key === 'Enter') { var n = state.newPlayerName.trim(); if (n && !state.profiles[n]) { state.profiles[n] = { solvedWords: { facil: [], medio: [], dificil: [] }, perfectRuns: { facil: false, medio: false, dificil: false }, ranks: { facil: 0, medio: 0, dificil: 0 }, globalRank: 0 }; saveProfilesToStorage(); renderProfiles(); showWindow('profiles'); } } else if (d.key === 'Shift') { state.isShiftActive = !state.isShiftActive; renderPlayerKeyboard(); } else { if (state.newPlayerName.length < 12) { state.newPlayerName += state.isShiftActive ? d.key.toUpperCase() : d.key.toLowerCase(); } } ui.playerNameDisplay.textContent = state.newPlayerName || '_'; });
                EventBus.on('game:start', function(d) { GameManager.startGame(d.difficulty); });
                EventBus.on('game:guess', function(d) { GameManager.handleGuess(d.letter); });
                EventBus.on('game:victory', function() { showWindow('victory'); });
                EventBus.on('game:defeat', function(d) { ui.gameOverCorrectWord.textContent = 'EL T\u00c9RMINO ERA: ' + d.correctWord; showWindow('gameOver'); });
                EventBus.on('command:executed', function(d) { if (d.commandType === 'DeleteProfile') { AudioManager.playSound('error'); ui.undoNotification.classList.add('visible'); clearTimeout(undoTimeout); undoTimeout = setTimeout(function() { ui.undoNotification.classList.remove('visible'); }, 5000); } });
                EventBus.on('command:undone', function(d) { if (d.commandType === 'DeleteProfile') { AudioManager.playSound('success'); } });
                setTimeout(function() { showWindow('title'); }, 1000);
                console.log('[BOOT][INFO] PREFLIGHT OK. SISTEMA TOTALMENTE COMPATIBLE CON MANIFIESTO.');
            });
        })();
    </script>
</body>
</html>
