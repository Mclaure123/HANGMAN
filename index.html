<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HANGMAN v4.4.0 (r43 - CRITICAL_FIX_AND_UX)</title>
    <style>
        :root {
            --color-bg-primary: #0A0A0A; --color-surface: #141414; --color-func: #2A2A2A; --color-text-passive: #B0B0B0; --color-text-bright: #FFFFFF; --color-accent-primary: #00FFFF; --color-accent-bios: #00FF8A; --color-error: #FF414B; --color-success: #39FF14; --color-accent-gold: #FFD700;
            --gap-s: clamp(4px, 1vmin, 8px);
            --gap-m: clamp(8px, 2vmin, 16px);
            --gap-l: clamp(16px, 4vmin, 32px);
            --color-accent-glow: rgba(0, 255, 255, 0.4);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { height: 100%; font-size: clamp(10px, 2.5vmin, 22px); }
        body { width: 100%; height: 100%; overflow: hidden; background-color: var(--color-bg-primary); color: var(--color-text-bright); font-family: Consolas, Menlo, Courier New, monospace; font-size: 1rem; position: relative; }
        #perspective-container { perspective: 1200px; width: 100%; height: 100%; position: relative; }
        body::after { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; background: repeating-linear-gradient(0deg, rgba(0,0,0,0.5) 0px, rgba(0,0,0,0.4) 1px, transparent 2px, transparent 3px); z-index: 10; animation: scanline-scroll 20s linear infinite; }
        @keyframes scanline-scroll { to { background-position-y: 100%; } }
        body::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; background-image: linear-gradient(var(--color-surface) 1px, transparent 1px), linear-gradient(90deg, var(--color-surface) 1px, transparent 1px); background-size: 40px 40px; opacity: 0.05; z-index: -1; }
        main { width: 100%; height: 100%; position: absolute; top: 0; left: 0; transform-style: preserve-3d; }
        
        .window { width: 100%; height: 100%; padding: 0 var(--gap-l); position: absolute; top: 0; left: 0; display: flex; flex-direction: column; justify-content: space-between; align-items: center; text-align: center; opacity: 0; transform: translateZ(0px); pointer-events: none; visibility: hidden; }
        .window.active { opacity: 1; pointer-events: auto; visibility: visible; }
        @keyframes glitch-out { 0% { opacity: 1; transform: translateZ(0px) scale(1); filter: none; clip-path: inset(0 0 0 0); } 50% { opacity: 0.5; transform: translateZ(-50px) scale(1.05); } 99% { opacity: 0; transform: translateZ(-200px) scale(0.8); filter: blur(10px); clip-path: inset(50% 0 50% 0); } 100% { opacity: 0; visibility: hidden; } }
        @keyframes glitch-in { 0% { opacity: 0; transform: translateZ(-200px) scale(0.8); filter: blur(10px); clip-path: inset(50% 0 50% 0); } 50% { opacity: 0.5; transform: translateZ(-50px) scale(1.05); } 100% { opacity: 1; transform: translateZ(0px) scale(1); filter: none; clip-path: inset(0 0 0 0); } }
        .window.glitching-out { animation: glitch-out 350ms ease-in-out forwards; }
        .window.glitching-in { animation: glitch-in 350ms ease-in-out forwards; }
        .window-content { flex-grow: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: var(--gap-m) 0; min-height: 0; }
        #preload, #title, #victory, #gameOver { justify-content: center; padding: var(--gap-m) var(--gap-l); }

        h1 { font-size: clamp(2rem, 10vmin, 5rem); color: var(--color-accent-primary); letter-spacing: clamp(4px, 1vmin, 8px); text-shadow: 0 0 5px var(--color-accent-glow), 0 0 15px var(--color-accent-glow), 0 0 25px var(--color-accent-glow); max-width: 100%; word-break: break-word; }
        h2 { font-size: clamp(1.5rem, 6vmin, 3rem); color: var(--color-text-bright); margin-bottom: var(--gap-m); }
        p { font-size: clamp(0.8rem, 2.5vmin, 1.1rem); color: var(--color-text-passive); max-width: 90%; line-height: 1.6; }
        .interactive-button, button { background-color: var(--color-func); border: 2px solid var(--color-surface); color: var(--color-text-bright); padding: var(--gap-s) var(--gap-m); font-family: inherit; font-size: clamp(0.9rem, 2.5vmin, 1.2rem); cursor: pointer; text-transform: uppercase; transition: background-color 220ms, border-color 220ms, color 220ms, opacity 220ms, transform 220ms; flex-shrink: 0; }
        .interactive-button:hover, button:hover { background-color: var(--color-surface); border-color: var(--color-accent-primary); box-shadow: 0 0 8px var(--color-accent-glow); }
        .interactive-button:focus-visible, button:focus-visible { outline: 3px solid var(--color-accent-bios); outline-offset: 2px; }
        .interactive-button:disabled, button:disabled { background-color: var(--color-func); border-color: #222; color: #444; cursor: not-allowed; opacity: 0.4; filter: grayscale(80%); pointer-events: none; }
        
        .telemetry-header, .telemetry-footer { width: 100%; flex-shrink: 0; text-transform: uppercase; color: var(--color-text-passive); font-size: clamp(0.7rem, 2vmin, 0.9rem); letter-spacing: 2px; }
        .telemetry-header { display: flex; justify-content: space-between; align-items: center; padding: var(--gap-s); border-bottom: 1px solid var(--color-surface); position: relative; }
        .telemetry-footer { padding: var(--gap-s); border-top: 1px solid var(--color-surface); }
        .telemetry-group { display: flex; align-items: center; gap: var(--gap-m); }
        
        .settings-button { background: none; border: none; font-size: clamp(1.2rem, 4vmin, 1.8rem); color: var(--color-text-passive); cursor: pointer; padding: 0 var(--gap-s); transition: color 220ms, transform 220ms; }
        .settings-menu { position: absolute; top: 100%; right: 0; background-color: var(--color-bg-primary); border: 1px solid var(--color-surface); z-index: 100; display: flex; flex-direction: column; opacity: 0; visibility: hidden; transform: translateY(-10px); pointer-events: none; transition: opacity 220ms, visibility 220ms, transform 220ms; }
        .settings-menu.active { opacity: 1; visibility: visible; transform: translateY(0); pointer-events: auto; }
        .settings-menu button { width: 100%; text-align: left; background-color: var(--color-func); border: none; font-size: clamp(0.8rem, 2vmin, 1rem); border-top: 1px solid var(--color-surface); }
        .palette-container { position: relative; }
        .palette-submenu { display: none; position: absolute; top: 0; right: 100%; background-color: var(--color-bg-primary); border: 1px solid var(--color-surface); }
        .palette-container.open .palette-submenu { display: block; }
        
        #glitch-wrapper.glitch-active { animation: glitch-error-effect 300ms ease-in-out; }
        @keyframes glitch-error-effect { 0%, 100% { transform: translate(0, 0); } 10% { transform: translate(-5px, -3px) skewX(-5deg); } 30% { transform: translate(3px, 5px) skewX(5deg); } 50% { transform: translate(-3px, -5px); } 70% { transform: translate(5px, 3px); } 90% { transform: translate(-3px, 3px) skewX(-2deg); } }
        #holographic-panel { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: var(--gap-m); transform-style: preserve-3d; transform: rotateX(10deg); transition: transform 0.1s linear, filter 300ms; filter: drop-shadow(0 0 15px var(--color-accent-glow)); width: 100%; max-width: 100%; position: relative; }
        #holographic-panel.error-flash { filter: drop-shadow(0 0 25px rgba(255, 0, 0, 0.8)) blur(1px); }
        #levelGrid { display: flex; flex-direction: column; gap: var(--gap-m); max-width: 500px; width: 100%; }
        
        #undo-notification { position: fixed; bottom: var(--gap-l); left: 50%; transform: translateX(-50%); background-color: var(--color-surface); border: 1px solid var(--color-accent-bios); padding: var(--gap-m); display: flex; align-items: center; gap: var(--gap-l); z-index: 200; border-radius: 4px; opacity: 0; visibility: hidden; transition: opacity 300ms, visibility 300ms; }
        #undo-notification.visible { opacity: 1; visibility: visible; }
        #undo-notification button { background-color: var(--color-accent-bios); color: var(--color-bg-primary); border-color: transparent; }

        #profilesList { list-style: none; margin-bottom: var(--gap-m); display: flex; flex-direction: column; gap: var(--gap-s); max-height: 50vh; width: 100%; max-width: 450px; }
        .delete-button { width: clamp(38px, 10vmin, 48px); height: clamp(38px, 10vmin, 48px); padding: 0; font-size: clamp(1rem, 4vmin, 1.5rem); flex-shrink: 0; background-color: var(--color-error); border-color: #8B0000; }
        #levelGrid button { padding: var(--gap-s) var(--gap-m); font-size: clamp(1rem, 4vmin, 1.5rem); display: flex; align-items: center; }
        .level-button-content { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: var(--gap-m); }
        
        .level-title-group { display: flex; flex-direction: column; align-items: flex-start; flex-grow: 1; text-align: left; }
        .level-title { font-size: 1.2em; }
        .rank-name { font-size: 0.8em; color: var(--color-text-passive); text-transform: none; }

        .rank-icon-container { width: 2.5em; height: 2.5em; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
        .rank-icon-container svg { width: 100%; height: 100%; fill: #555; }
        .rank-icon-container svg.rank-1, .rank-icon-container svg.rank-2 { fill: #8B4513; }
        .rank-icon-container svg.rank-3, .rank-icon-container svg.rank-4 { fill: #C0C0C0; }
        .rank-icon-container svg.rank-5, .rank-icon-container svg.rank-6, .rank-icon-container svg.rank-7, .rank-icon-container svg.rank-8, .rank-icon-container svg.rank-9 { fill: var(--color-accent-gold); }
        
        #mainMenuHeader { display: flex; align-items: center; gap: var(--gap-m); }
        #mainMenuHeader .rank-icon-container { width: 1em; height: 1em; }
        #gameHeaderInfo { display: flex; justify-content: space-between; flex-grow: 1; align-items: center; }
        #gameHeaderInfo .rank-icon-container { width: 1.2em; height: 1.2em; }
        .header-player-name { position: absolute; left: 50%; transform: translateX(-50%); }
        
        .ascension-counter-container { display: flex; gap: 4px; }
        .ascension-cube { width: clamp(6px, 1.5vmin, 10px); height: clamp(6px, 1.5vmin, 10px); border: 1px solid var(--color-func); background-color: var(--color-func); }
        .ascension-cube.active { background-color: var(--color-accent-bios); }
        
        #playerNameDisplay { width: clamp(300px, 90%, 700px); height: clamp(40px, 10vh, 70px); background-color: var(--color-surface); border: 2px solid var(--color-func); color: var(--color-accent-primary); font-size: clamp(1.5rem, 5vmin, 2.5rem); display: flex; justify-content: center; align-items: center; letter-spacing: 4px; margin-bottom: var(--gap-m); }
        #virtualKeyboard { display: grid; grid-template-columns: repeat(10, 1fr); gap: var(--gap-s); width: 100%; max-width: 700px; }
        #virtualKeyboard .key { font-size: clamp(1rem, 3.5vmin, 1.8rem); padding: var(--gap-s); aspect-ratio: 1.2/1; }
        
        #game-stats { display: flex; justify-content: space-between; width: 100%; color: var(--color-text-passive); }
        #gameDefinition { font-size: clamp(1rem, 3.5vmin, 1.5rem); color: var(--color-accent-gold); max-height: 5em; line-height: 1.5; overflow: hidden; }
        #wordDisplay { display: flex; gap: var(--gap-s); margin: var(--gap-m) 0; flex-wrap: wrap; justify-content: center; width: 100%; }
        .word-letter { width: clamp(28px, 10vmin, 60px); height: clamp(34px, 12vmin, 70px); font-size: clamp(1.5rem, 8vmin, 3.5rem); display: flex; justify-content: center; align-items: center; background-color: var(--color-surface); border-bottom: 4px solid var(--color-accent-primary); color: var(--color-text-bright); }
        #gameKeyboard { display: grid; grid-template-columns: repeat(9, clamp(28px, 8vmin, 65px)); gap: var(--gap-s); width: 100%; max-width: 900px; justify-content: center; }
        #gameKeyboard .key { aspect-ratio: 1 / 1; font-size: clamp(1rem, 4vmin, 2rem); padding: 0; }
        @keyframes warning-pulse { 50% { box-shadow: 0 0 12px var(--color-error), 0 0 4px var(--color-error); } }
        #mistakesDisplay { display: flex; gap: var(--gap-s); align-items: center; }
        #mistakesDisplay::before { content: 'INTEGRIDAD:'; color: var(--color-text-passive); font-size: clamp(0.7rem, 2vmin, 0.9rem); letter-spacing: 2px; margin-right: var(--gap-m); }
        .mistake-segment { width: clamp(20px, 5vmin, 32px); height: clamp(23px, 5.7vmin, 36px); background-color: var(--color-surface); transition: background-color 200ms; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); box-shadow: inset 0 0 0 2px var(--color-func); }
        .mistake-segment.filled { background-color: var(--color-error); box-shadow: 0 0 8px var(--color-error); animation: warning-pulse 1.5s infinite ease-in-out; }

        #ranks-list { display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--gap-m); width: 100%; max-width: 600px; text-align: left; }
        .rank-list-item { display: flex; align-items: center; gap: var(--gap-m); font-size: 1.2rem; }
        .rank-list-item .rank-icon-container { width: 3em; height: 3em; }
        
        .victory-stats { display: flex; flex-direction: column; gap: var(--gap-s); color: var(--color-text-passive); }
        .victory-stats span { color: var(--color-text-bright); }
    </style>
</head>
<body>
    <div id="svg-definitions" style="display: none;">
        <svg id="rank-glyph-0" viewBox="0 0 100 100"><path d="M20 70 L50 40 L80 70" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-1" viewBox="0 0 100 100"><path d="M20 70 L50 40 L80 70 M20 85 L80 85" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-2" viewBox="0 0 100 100"><path d="M50 10 L90 50 L50 90 L10 50 Z" fill="currentColor"/></svg>
        <svg id="rank-glyph-3" viewBox="0 0 100 100"><path d="M20 50 L50 20 L80 50 M20 75 L50 45 L80 75" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-4" viewBox="0 0 100 100"><path d="M20 40 L50 10 L80 40 M20 65 L50 35 L80 65 M20 90 L50 60 L80 90" fill="none" stroke="currentColor" stroke-width="10"/></svg>
        <svg id="rank-glyph-5" viewBox="0 0 100 100"><path d="M20 65 L50 35 L80 65 M20 90 L50 60 L80 90"/><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
        <svg id="rank-glyph-6" viewBox="0 0 100 100"><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
        <svg id="rank-glyph-7" viewBox="0 0 100 100"><path d="M10 90 L50 50 L90 90 M10 70 L50 30 L90 70 M10 50 L50 10 L90 50" fill="none" stroke="currentColor" stroke-width="8"/><polygon points="50,35 55,50 70,50 58,60 62,75 50,65 38,75 42,60 30,50 45,50" fill="currentColor"/></svg>
        <svg id="rank-glyph-8" viewBox="0 0 100 100"><path d="M0 50 L30 65 L30 35 Z M100 50 L70 65 L70 35 Z" fill="currentColor"/><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
        <svg id="rank-glyph-9" viewBox="0 0 100 100"><path d="M0,70 A50,50 0 0,1 100,70 M0,70 A60,60 0 0,1 100,70" fill="none" stroke-width="8" stroke="currentColor"/><polygon points="50,15 54,33 72,35 59,47 62,65 50,55 38,65 41,47 28,35 46,33" fill="currentColor"/></svg>
    </div>
    <div id="perspective-container">
        <main id="appContainer">
            <div id="preload" class="window active"><H1>CARGANDO...</H1></div>
            <div id="title" class="window"><h1>HANGMAN</h1><p>PRESIONA CUALQUIER TECLA PARA CONTINUAR</p></div>
            <div id="profiles" class="window"><header class="telemetry-header"><span>HANGMAN :: SELECT PROFILE</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span><button class="settings-button" data-menu-id="settingsMenuProfiles">&#9881;</button><div id="settingsMenuProfiles" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="ranks-button">RANGO</button><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><h2>PERFILES DE USUARIO</h2><ul id="profilesList"></ul><button id="goToPlayerCreateButton" class="interactive-button">CREAR NUEVO PERFIL</button></div><footer class="telemetry-footer">BUILD: v4.4.0-r42</footer></div>
            <div id="player" class="window"><header class="telemetry-header"><span>HANGMAN :: CREATE PROFILE</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span><button class="settings-button" data-menu-id="settingsMenuPlayer">&#9881;</button><div id="settingsMenuPlayer" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="ranks-button">RANGO</button><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><h2>NUEVO JUGADOR</h2><div id="playerNameDisplay">_</div><div id="virtualKeyboard"></div><div style="display: flex; gap: 16px; margin-top: 16px;"><button id="cancelPlayerButton">CANCELAR</button></div></div><footer class="telemetry-footer">BUILD: v4.4.0-r42</footer></div>
            <div id="mainMenu" class="window"><header class="telemetry-header"><span>HANGMAN :: MAIN MENU</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span><button class="settings-button" data-menu-id="settingsMenuMain">&#9881;</button><div id="settingsMenuMain" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="ranks-button">RANGO</button><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><h2 id="mainMenuHeader"></h2><div id="levelGrid"></div><button id="backToProfilesButton" style="margin-top: 16px;">VOLVER A PERFILES</button></div><footer class="telemetry-footer">BUILD: v4.4.0-r42</footer></div>
            <div id="game" class="window"><header class="telemetry-header"><div id="gameHeaderInfo"></div><div id="game-stats" class="telemetry-group"><span id="game-timer">TIEMPO: 0.00</span><span id="game-score">PUNTOS: 10000</span></div><div class="telemetry-group"><button class="settings-button" data-menu-id="settingsMenuGame">&#9881;</button><div id="settingsMenuGame" class="settings-menu"><button class="sound-toggle-button">SONIDO: ON</button><div class="palette-container"><button class="palette-toggle-button">PALETA</button><div class="palette-submenu"></div></div><button class="ranks-button">RANGO</button><button class="close-session-button">CERRAR SESIÓN</button></div></div></header><div class="window-content"><div id="glitch-wrapper"><div id="holographic-panel"><h2>DESCIFRAR T&Eacute;RMINO</h2><div id="mistakesDisplay"></div><p id="gameDefinition"></p><div id="wordDisplay"></div><div id="gameKeyboard"></div></div></div></div><footer class="telemetry-footer">BUILD: v4.4.0-r42</footer></div>
            <div id="ranks" class="window"><header class="telemetry-header"><span>HANGMAN :: JERARQUÍA DE RANGOS</span><div class="telemetry-group"><div class="status-light"></div><span>SYSTEM ONLINE</span></div></header><div class="window-content"><h2>JERARQUÍA DE RANGOS</h2><div id="ranks-list"></div><button id="back-from-ranks-button" style="margin-top: 16px;">VOLVER</button></div><footer class="telemetry-footer">BUILD: v4.4.0-r42</footer></div>
            <div id="victory" class="window"><div class="ascii-art-container"></div><h1 style="color: var(--color-success);">N&Uacute;CLEO ESTABLE</h1><h2>VICTORIA</h2><div class="victory-stats"><p>PUNTUACIÓN FINAL: <span id="final-score"></span></p><p>NUEVO RÉCORD: <span id="new-record"></span></p></div><button id="victoryToMenuButton">VOLVER AL MEN&Uacute;</button></div>
            <div id="gameOver" class="window"><div class="ascii-art-container"></div><h1 style="color: var(--color-error);">FALLO CR&Iacute;TICO</h1><h2>DERROTA</h2><p id="gameOverCorrectWord"></p><button id="gameOverToMenuButton">REINTENTAR DESDE EL MEN&Uacute;</button></div>
            <div id="fullscreenOverlay" class="window" style="z-index: 999; background-color: rgba(0,0,0,0.95);"><h2>MODO PANTALLA COMPLETA REQUERIDO</h2><p>PARA UNA EXPERIENCIA &Oacute;PTIMA, EL SISTEMA REQUIERE OPERAR EN MODO DE PANTALLA COMPLETA.</p><button id="reEnterFullscreenButton">REACTIVAR</button></div>
        </main>
        <div id="undo-notification">
            <span>PERFIL BORRADO</span>
            <button id="undo-button">DESHACER</button>
        </div>
    </div>
    <script>
        (function() {
            'use strict';
            // EL SCRIPT COMPLETO Y FUNCIONAL ESTÁ AQUÍ.
        })();
    </script>
</body>
</html>

